import{S as se,i as oe,s as ae,e as w,t as V,k as I,c as E,a as x,h as A,d as _,m as N,b as G,g as v,L as b,n as L,o as y,p as U,q as $,K as F,E as K,w as P,x as q,y as B,B as R,l as T,M as ie,j as fe,N as X,O as me,P as _e,Q as z,R as he,T as de,U as ge,V as $e}from"../chunks/index-4f5f6f58.js";import{s as H,g as j,a as ce,n as be}from"../chunks/index.browser-1d75288f.js";import{S as ve,_ as ye,a as ke}from"../chunks/sidebarTile-7590f97d.js";import{g as we,F as Ee,a as xe,B as Se,I as Ge}from"../chunks/fontGenerator-18cf161f.js";import{c as Ie}from"../chunks/shapes-f7969361.js";import"../chunks/index-c6e8df40.js";function J(a,t,n){const e=a.slice();return e[6]=t[n],e}function Ne(a){let t,n;return{c(){t=w("p"),n=V("No glyphs")},l(e){t=E(e,"P",{});var l=x(t);n=A(l,"No glyphs"),l.forEach(_)},m(e,l){v(e,t,l),b(t,n)},p:K,i:K,o:K,d(e){e&&_(t)}}}function De(a){let t,n,e=a[2],l=[];for(let i=0;i<e.length;i+=1)l[i]=Z(J(a,e,i));const r=i=>y(l[i],1,1,()=>{l[i]=null});return{c(){for(let i=0;i<l.length;i+=1)l[i].c();t=T()},l(i){for(let o=0;o<l.length;o+=1)l[o].l(i);t=T()},m(i,o){for(let s=0;s<l.length;s+=1)l[s].m(i,o);v(i,t,o),n=!0},p(i,o){if(o&519){e=i[2];let s;for(s=0;s<e.length;s+=1){const c=J(i,e,s);l[s]?(l[s].p(c,o),$(l[s],1)):(l[s]=Z(c),l[s].c(),$(l[s],1),l[s].m(t.parentNode,t))}for(L(),s=e.length;s<l.length;s+=1)r(s);U()}},i(i){if(!n){for(let o=0;o<e.length;o+=1)$(l[o]);n=!0}},o(i){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)y(l[o]);n=!1},d(i){ie(l,i),i&&_(t)}}}function Y(a){let t,n,e=a[9].names.fontSubfamily.en+"",l,r,i,o;return i=new xe({props:{canvasWidth:300,font:a[9],text:a[1]}}),{c(){t=w("div"),n=w("p"),l=V(e),r=I(),P(i.$$.fragment),this.h()},l(s){t=E(s,"DIV",{class:!0});var c=x(t);n=E(c,"P",{class:!0});var m=x(n);l=A(m,e),m.forEach(_),r=N(c),q(i.$$.fragment,c),c.forEach(_),this.h()},h(){G(n,"class","text-small font-mono text-slate-900 text-sm"),G(t,"class","space-y-2")},m(s,c){v(s,t,c),b(t,n),b(n,l),b(t,r),B(i,t,null),o=!0},p(s,c){(!o||c&512)&&e!==(e=s[9].names.fontSubfamily.en+"")&&fe(l,e);const m={};c&512&&(m.font=s[9]),c&2&&(m.text=s[1]),i.$set(m)},i(s){o||($(i.$$.fragment,s),o=!0)},o(s){y(i.$$.fragment,s),o=!1},d(s){s&&_(t),R(i)}}}function Ve(a){let t,n,e=a[9]&&Y(a);return{c(){e&&e.c(),t=I()},l(l){e&&e.l(l),t=N(l)},m(l,r){e&&e.m(l,r),v(l,t,r),n=!0},p(l,r){l[9]?e?(e.p(l,r),r&512&&$(e,1)):(e=Y(l),e.c(),$(e,1),e.m(t.parentNode,t)):e&&(L(),y(e,1,1,()=>{e=null}),U())},i(l){n||($(e),n=!0)},o(l){y(e),n=!1},d(l){e&&e.d(l),l&&_(t)}}}function Z(a){let t,n;return t=new Ee({props:{syntax:a[6],glyphs:[a[0]],$$slots:{default:[Ve,({font:e})=>({9:e}),({font:e})=>e?512:0]},$$scope:{ctx:a}}}),{c(){P(t.$$.fragment)},l(e){q(t.$$.fragment,e)},m(e,l){B(t,e,l),n=!0},p(e,l){const r={};l&4&&(r.syntax=e[6]),l&1&&(r.glyphs=[e[0]]),l&1538&&(r.$$scope={dirty:l,ctx:e}),t.$set(r)},i(e){n||($(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function Ae(a){let t,n,e,l,r,i,o;const s=[De,Ne],c=[];function m(f,h){return f[0]?0:1}return r=m(a),i=c[r]=s[r](a),{c(){t=w("div"),n=w("p"),e=V("Anteprima"),l=I(),i.c(),this.h()},l(f){t=E(f,"DIV",{class:!0});var h=x(t);n=E(h,"P",{class:!0});var u=x(n);e=A(u,"Anteprima"),u.forEach(_),l=N(h),i.l(h),h.forEach(_),this.h()},h(){G(n,"class","text-small font-mono text-slate-900 text-sm"),G(t,"class","space-y-8")},m(f,h){v(f,t,h),b(t,n),b(n,e),b(t,l),c[r].m(t,null),o=!0},p(f,[h]){let u=r;r=m(f),r===u?c[r].p(f,h):(L(),y(c[u],1,1,()=>{c[u]=null}),U(),i=c[r],i?i.p(f,h):(i=c[r]=s[r](f),i.c()),$(i,1),i.m(t,null))},i(f){o||($(i),o=!0)},o(f){y(i),o=!1},d(f){f&&_(t),c[r].d()}}}function Te(a,t,n){let e,l,r;F(a,H,c=>n(3,e=c)),F(a,j,c=>n(4,l=c)),F(a,ce,c=>n(2,r=c));let i,o;function s(c){try{return String.fromCharCode(we(c.name))}catch(m){return console.log(m),""}}return a.$$.update=()=>{a.$$.dirty&24&&e&&n(0,i=l.find(c=>c.id===e)),a.$$.dirty&1&&i&&n(1,o=s(i))},[i,o,r,e,l]}class Pe extends se{constructor(t){super(),oe(this,t,Te,Ae,ae,{})}}function ee(a,t,n){const e=a.slice();return e[8]=t[n],e[9]=t,e[10]=n,e}function te(a,t,n){const e=a.slice();return e[8]=t[n],e}function qe(a){let t;return{c(){t=V("+ Aggiungi glifo")},l(n){t=A(n,"+ Aggiungi glifo")},m(n,e){v(n,t,e)},d(n){n&&_(t)}}}function Be(a){let t,n;return t=new Se({props:{$$slots:{default:[qe]},$$scope:{ctx:a}}}),t.$on("click",a[2]),{c(){P(t.$$.fragment)},l(e){q(t.$$.fragment,e)},m(e,l){B(t,e,l),n=!0},p(e,l){const r={};l&8192&&(r.$$scope={dirty:l,ctx:e}),t.$set(r)},i(e){n||($(t.$$.fragment,e),n=!0)},o(e){y(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function Re(a){let t;return{c(){t=V("Lista glifi")},l(n){t=A(n,"Lista glifi")},m(n,e){v(n,t,e)},d(n){n&&_(t)}}}function Ce(a){let t=a[8].name+"",n,e;return{c(){n=V(t),e=I()},l(l){n=A(l,t),e=N(l)},m(l,r){v(l,n,r),v(l,e,r)},p(l,r){r&1&&t!==(t=l[8].name+"")&&fe(n,t)},d(l){l&&_(n),l&&_(e)}}}function le(a,t){let n,e,l;return e=new ke({props:{selection:H,id:t[8].id,$$slots:{default:[Ce]},$$scope:{ctx:t}}}),{key:a,first:null,c(){n=T(),P(e.$$.fragment),this.h()},l(r){n=T(),q(e.$$.fragment,r),this.h()},h(){this.first=n},m(r,i){v(r,n,i),B(e,r,i),l=!0},p(r,i){t=r;const o={};i&1&&(o.id=t[8].id),i&8193&&(o.$$scope={dirty:i,ctx:t}),e.$set(o)},i(r){l||($(e.$$.fragment,r),l=!0)},o(r){y(e.$$.fragment,r),l=!1},d(r){r&&_(n),R(e,r)}}}function Fe(a){let t=[],n=new Map,e,l,r=a[0];const i=o=>o[8].id;for(let o=0;o<r.length;o+=1){let s=te(a,r,o),c=i(s);n.set(c,t[o]=le(c,s))}return{c(){for(let o=0;o<t.length;o+=1)t[o].c();e=T()},l(o){for(let s=0;s<t.length;s+=1)t[s].l(o);e=T()},m(o,s){for(let c=0;c<t.length;c+=1)t[c].m(o,s);v(o,e,s),l=!0},p(o,s){s&1&&(r=o[0],L(),t=he(t,s,i,1,o,r,n,e.parentNode,de,le,e,te),U())},i(o){if(!l){for(let s=0;s<r.length;s+=1)$(t[s]);l=!0}},o(o){for(let s=0;s<t.length;s+=1)y(t[s]);l=!1},d(o){for(let s=0;s<t.length;s+=1)t[s].d(o);o&&_(e)}}}function ne(a){let t,n,e,l,r,i,o,s,c,m,f,h,u,p,k,d,D,C;function ue(g){a[4](g,a[8])}let Q={};a[8].name!==void 0&&(Q.value=a[8].name),r=new Ge({props:Q}),ge.push(()=>$e(r,"value",ue));function pe(){a[5].call(p,a[9],a[10])}return{c(){t=w("div"),n=w("p"),e=V("Nome glifo"),l=I(),P(r.$$.fragment),o=I(),s=w("hr"),c=I(),m=w("div"),f=w("p"),h=V("Struttura glifo"),u=I(),p=w("textarea"),k=I(),this.h()},l(g){t=E(g,"DIV",{class:!0});var S=x(t);n=E(S,"P",{class:!0});var M=x(n);e=A(M,"Nome glifo"),M.forEach(_),l=N(S),q(r.$$.fragment,S),S.forEach(_),o=N(g),s=E(g,"HR",{}),c=N(g),m=E(g,"DIV",{class:!0});var O=x(m);f=E(O,"P",{class:!0});var W=x(f);h=A(W,"Struttura glifo"),W.forEach(_),u=N(O),p=E(O,"TEXTAREA",{class:!0}),x(p).forEach(_),k=N(O),O.forEach(_),this.h()},h(){G(n,"class","text-small font-mono text-slate-900 mb-2 text-sm"),G(t,"class","shrink-0"),G(f,"class","text-small font-mono text-slate-900 mb-2 text-sm"),G(p,"class","h-0 grow p-2 bg-slate-200 tracking-[0.75em] hover:bg-slate-300 font-mono focus:ring-4"),G(m,"class","grow flex flex-col items-stretch")},m(g,S){v(g,t,S),b(t,n),b(n,e),b(t,l),B(r,t,null),v(g,o,S),v(g,s,S),v(g,c,S),v(g,m,S),b(m,f),b(f,h),b(m,u),b(m,p),X(p,a[8].structure),b(m,k),d=!0,D||(C=me(p,"input",pe),D=!0)},p(g,S){a=g;const M={};!i&&S&1&&(i=!0,M.value=a[8].name,_e(()=>i=!1)),r.$set(M),S&1&&X(p,a[8].structure)},i(g){d||($(r.$$.fragment,g),d=!0)},o(g){y(r.$$.fragment,g),d=!1},d(g){g&&_(t),R(r),g&&_(o),g&&_(s),g&&_(c),g&&_(m),D=!1,C()}}}function re(a){let t,n,e=a[8].id==a[1]&&ne(a);return{c(){e&&e.c(),t=T()},l(l){e&&e.l(l),t=T()},m(l,r){e&&e.m(l,r),v(l,t,r),n=!0},p(l,r){l[8].id==l[1]?e?(e.p(l,r),r&3&&$(e,1)):(e=ne(l),e.c(),$(e,1),e.m(t.parentNode,t)):e&&(L(),y(e,1,1,()=>{e=null}),U())},i(l){n||($(e),n=!0)},o(l){y(e),n=!1},d(l){e&&e.d(l),l&&_(t)}}}function Le(a){let t,n,e,l,r,i,o,s,c;e=new ve({props:{$$slots:{items:[Fe],listTitle:[Re],topArea:[Be]},$$scope:{ctx:a}}});let m=a[0],f=[];for(let u=0;u<m.length;u+=1)f[u]=re(ee(a,m,u));const h=u=>y(f[u],1,1,()=>{f[u]=null});return s=new Pe({}),{c(){t=w("div"),n=w("div"),P(e.$$.fragment),l=I(),r=w("div");for(let u=0;u<f.length;u+=1)f[u].c();i=I(),o=w("div"),P(s.$$.fragment),this.h()},l(u){t=E(u,"DIV",{class:!0});var p=x(t);n=E(p,"DIV",{class:!0});var k=x(n);q(e.$$.fragment,k),k.forEach(_),l=N(p),r=E(p,"DIV",{class:!0});var d=x(r);for(let C=0;C<f.length;C+=1)f[C].l(d);d.forEach(_),i=N(p),o=E(p,"DIV",{class:!0});var D=x(o);q(s.$$.fragment,D),D.forEach(_),p.forEach(_),this.h()},h(){G(n,"class","shrink-0 flex items-stretch"),G(r,"class","p-8 space-y-8 grow flex flex-col items-stretch"),G(o,"class","p-8 border border-l-gray-300 overflow-y-scroll"),G(t,"class","flex flex-row flex-nowrap items-stretch overflow-hidden grow")},m(u,p){v(u,t,p),b(t,n),B(e,n,null),b(t,l),b(t,r);for(let k=0;k<f.length;k+=1)f[k].m(r,null);b(t,i),b(t,o),B(s,o,null),c=!0},p(u,[p]){const k={};if(p&8193&&(k.$$scope={dirty:p,ctx:u}),e.$set(k),p&3){m=u[0];let d;for(d=0;d<m.length;d+=1){const D=ee(u,m,d);f[d]?(f[d].p(D,p),$(f[d],1)):(f[d]=re(D),f[d].c(),$(f[d],1),f[d].m(r,null))}for(L(),d=m.length;d<f.length;d+=1)h(d);U()}},i(u){if(!c){$(e.$$.fragment,u);for(let p=0;p<m.length;p+=1)$(f[p]);$(s.$$.fragment,u),c=!0}},o(u){y(e.$$.fragment,u),f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)y(f[p]);y(s.$$.fragment,u),c=!1},d(u){u&&_(t),R(e),ie(f,u),R(s)}}}function Ue(a,t){for(let n of a.rules)if(n.symbol==t)return n;throw new Error("missingSymbol")}function Me(a,t,n){let e,l,r;F(a,ce,f=>n(3,e=f)),F(a,j,f=>n(0,l=f)),F(a,H,f=>n(1,r=f)),l.length||i();function i(){const f={id:be(5),name:"[aggiungi nome]",structure:""};z(j,l=[...l,f],l),z(H,r=f.id,r)}function o(f){const h=[];for(const u of f){const p=u.structure.replace(/(\r\n|\n|\r)/gm,"");p&&h.push(...p.split(""))}return ye.uniq(h)}function s(f,h){const u=f.rules.map(p=>p.symbol);for(let p of h)u.includes(p)||f.rules.push(Ie(p));for(let p of u)if(!o(l).includes(p)){const k=Ue(f,p),d=f.rules.indexOf(k);f.rules.splice(d,1)}}function c(f,h){a.$$.not_equal(h.name,f)&&(h.name=f,j.set(l))}function m(f,h){f[h].structure=this.value,j.set(l)}return a.$$.update=()=>{if(a.$$.dirty&9){const f=o(l);for(let h of e)s(h,f)}},[l,r,i,e,c,m]}class Xe extends se{constructor(t){super(),oe(this,t,Me,Le,ae,{})}}export{Xe as default};
